<div class="container mt-4">
  <h2 class="text-center">Job List</h2>
  <button class="btn btn-primary mb-3" (click)="openAddModal()">
    Add Job Post
  </button>
  <div class="table-responsive">
    <!-- Added div for responsiveness -->
    <table class="table table-bordered table-striped">
      <!-- Added table-striped for better design -->
      <thead>
        <tr>
          <th>Sn.</th>
          <th>Title</th>
          <th>Company</th>
          <th>Description</th>
          <th>Created At</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of datas; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ item.title }}</td>
          <td>{{ item.company }}</td>
          <td>{{ item.description.substr(0, 100) }}</td>
          <td>{{ item.application_date | date : "medium" }}</td>
          <td>
            <button class="btn btn-danger" (click)="delete(item.id)">
              Delete
            </button>
            <!-- Changed to apply method -->
            <button class="btn btn-secondary" (click)="openModal(item)">
              View
            </button>
          </td>
        </tr>
        <tr *ngIf="!datas.length" colspan="6">
          <!-- Adjusted colspan to match the number of columns -->
          <td>No data available</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div
    class="modal fade"
    tabindex="-1"
    role="dialog"
    [ngClass]="{ show: showModal }"
    (click)="closeModal()"
  >
    <div class="modal-dialog modal-xl" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Job Details</h5>
          <button
            type="button"
            class="close"
            aria-label="Close"
            (click)="closeModal()"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>
            {{ selected?.job_title }} | {{ selected?.company_name }} |
            {{ selected?.location }}
          </p>
          <hr />
          <p>{{ selected?.job_description }}</p>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            (click)="closeModal()"
          >
            Close
          </button>
        </div>
      </div>
    </div>
  </div>

  <div
    class="modal fade"
    id="jobModal"
    tabindex="-1"
    [ngClass]="{ show: showAddEditModal }"
    [ngStyle]="{ display: showAddEditModal ? 'block' : 'none' }"
  >
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">
            {{ isEditMode ? "Edit Job Post" : "Add Job Post" }}
          </h5>
          <button
            type="button"
            class="close"
            aria-label="Close"
            (click)="closeAddEditModal()"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form (ngSubmit)="isEditMode ? updateJob() : createJob()">
            <!-- Removed submitted = true from here -->
            <div class="form-group">
              <label for="title">Title *</label>
              <input
                type="text"
                id="title"
                [(ngModel)]="newJob.title"
                name="title"
                class="form-control"
                required
              />
              <div *ngIf="submitted && !newJob.title" class="text-danger">
                Title is required.
              </div>
              <!-- Show message after submit -->
            </div>
            <div class="form-group">
              <label for="company">Company *</label>
              <input
                type="text"
                id="company"
                [(ngModel)]="newJob.company"
                name="company"
                class="form-control"
                required
              />
              <div *ngIf="submitted && !newJob.company" class="text-danger">
                Company is required.
              </div>
              <!-- Show message after submit -->
            </div>
            <div class="form-group">
              <label for="description">Description *</label>
              <textarea
                id="description"
                [(ngModel)]="newJob.description"
                name="description"
                class="form-control"
                required
              ></textarea>
              <div *ngIf="submitted && !newJob.description" class="text-danger">
                Description is required.
              </div>
              <!-- Show message after submit -->
            </div>
            <button type="submit" class="btn btn-primary">
              {{ isEditMode ? "Update Job" : "Create Job" }}
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <ngx-spinner
    bdColor="rgba(0, 0, 0, 0.8)"
    [fullScreen]="true"
    type="line-spin-fade"
    template="<img src='assets/spinner.gif' />"
  >
  </ngx-spinner>
</div>
